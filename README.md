# housing_project--ML--LR

housing project
import numpy as np
import matplotlib.pyplot as plt
from sklearn.model_selection import train_test_split #split data ino training data and test data
import pandas as pnd
price area bedrooms bathrooms stories mainroad guestroom basement hotwater
0 13300000 7420 4 2 3 yes no no
1 12250000 8960 4 4 4 yes no no
2 12250000 9960 3 2 2 yes no yes
3 12215000 7500 4 2 2 yes no yes
4 11410000 7420 4 1 2 yes yes yes
data_frame=pnd.read_csv("Housing.csv")
data_frame.head()
#les trois premières colonnes: features
#la dernière colonne target
y_data=data_frame['price'].values
X_area=data_frame['area'].values
X_bedrooms=data_frame['bedrooms'].values
X_bathrooms=data_frame['bathrooms'].values
x_area=np.array(X_area)
x_bedrooms=np.array(X_bedrooms)
x_bathrooms=np.array(X_bathrooms)
y=np.array(y_data)
print(y)
[13300000 12250000 12250000 12215000 11410000 10850000 10150000 10150000
9870000 9800000 9800000 9681000 9310000 9240000 9240000 9100000
9100000 8960000 8890000 8855000 8750000 8680000 8645000 8645000
8575000 8540000 8463000 8400000 8400000 8400000 8400000 8400000
8295000 8190000 8120000 8080940 8043000 7980000 7962500 7910000
7875000 7840000 7700000 7700000 7560000 7560000 7525000 7490000
7455000 7420000 7420000 7420000 7350000 7350000 7350000 7350000
7343000 7245000 7210000 7210000 7140000 7070000 7070000 7035000
7000000 6930000 6930000 6895000 6860000 6790000 6790000 6755000
6720000 6685000 6650000 6650000 6650000 6650000 6650000 6650000
6629000 6615000 6615000 6580000 6510000 6510000 6510000 6475000
6475000 6440000 6440000 6419000 6405000 6300000 6300000 6300000
6300000 6300000 6293000 6265000 6230000 6230000 6195000 6195000
6195000 6160000 6160000 6125000 6107500 6090000 6090000 6090000
6083000 6083000 6020000 6020000 6020000 5950000 5950000 5950000
5950000 5950000 5950000 5950000 5950000 5943000 5880000 5880000
5873000 5873000 5866000 5810000 5810000 5810000 5803000 5775000
5740000 5740000 5740000 5740000 5740000 5652500 5600000 5600000
5600000 5600000 5600000 5600000 5600000 5600000 5600000 5565000
5565000 5530000 5530000 5530000 5523000 5495000 5495000 5460000
5460000 5460000 5460000 5425000 5390000 5383000 5320000 5285000
5250000 5250000 5250000 5250000 5250000 5250000 5250000 5250000
5250000 5243000 5229000 5215000 5215000 5215000 5145000 5145000
5110000 5110000 5110000 5110000 5075000 5040000 5040000 5040000
5040000 5033000 5005000 4970000 4970000 4956000 4935000 4907000
4900000 4900000 4900000 4900000 4900000 4900000 4900000 4900000
4900000 4900000 4900000 4900000 4893000 4893000 4865000 4830000
4830000 4830000 4830000 4795000 4795000 4767000 4760000 4760000
4760000 4753000 4690000 4690000 4690000 4690000 4690000 4690000
4655000 4620000 4620000 4620000 4620000 4620000 4613000 4585000
4585000 4550000 4550000 4550000 4550000 4550000 4550000 4550000
4543000 4543000 4515000 4515000 4515000 4515000 4480000 4480000
4480000 4480000 4480000 4473000 4473000 4473000 4445000 4410000
4410000 4403000 4403000 4403000 4382000 4375000 4340000 4340000
4340000 4340000 4340000 4319000 4305000 4305000 4277000 4270000
4270000 4270000 4270000 4270000 4270000 4235000 4235000 4200000
4200000 4200000 4200000 4200000 4200000 4200000 4200000 4200000
4200000 4200000 4200000 4200000 4200000 4200000 4200000 4200000
4193000 4193000 4165000 4165000 4165000 4130000 4130000 4123000
6/10/23, 11:33 PM housing_project.ipynb - Colaboratory
https://colab.research.google.com/drive/1KNsAGlGGZ_kt4Xie1o2yXC8J6qELOLAX#scrollTo=8pXj0dJZVjLR&printMode=true 2/4
4098500 4095000 4095000 4095000 4060000 4060000 4060000 4060000
4060000 4025000 4025000 4025000 4007500 4007500 3990000 3990000
3990000 3990000 3990000 3920000 3920000 3920000 3920000 3920000
3920000 3920000 3885000 3885000 3850000 3850000 3850000 3850000
3850000 3850000 3850000 3836000 3815000 3780000 3780000 3780000
3780000 3780000 3780000 3773000 3773000 3773000 3745000 3710000
3710000 3710000 3710000 3710000 3703000 3703000 3675000 3675000
3675000 3675000 3640000 3640000 3640000 3640000 3640000 3640000
3640000 3640000 3640000 3633000 3605000 3605000 3570000 3570000
3570000 3570000 3535000 3500000 3500000 3500000 3500000 3500000
3500000 3500000 3500000 3500000 3500000 3500000 3500000 3500000
3500000 3500000 3500000 3500000 3493000 3465000 3465000 3465000
3430000 3430000 3430000 3430000 3430000 3430000 3423000 3395000
3395000 3395000 3360000 3360000 3360000 3360000 3360000 3360000
3360000 3360000 3353000 3332000 3325000 3325000 3290000 3290000
3290000 3290000 3290000 3290000 3290000 3290000 3255000 3255000
3234000 3220000 3220000 3220000 3220000 3150000 3150000 3150000
3150000 3150000 3150000 3150000 3150000 3150000 3143000 3129000
3118850 3115000 3115000 3115000 3087000 3080000 3080000 3080000
plt.figure(figsize=(8,6))
plt.title('Data area')
plt.scatter(X_area,y)
plt.xlabel('area')
plt.ylabel('price')
plt.show()
plt.figure(figsize=(8,6))
plt.title('Data bedrooms')
plt.scatter(x_bedrooms,y)
plt.xlabel('area')
plt.ylabel('price')
plt.show()
6/10/23, 11:33 PM housing_project.ipynb - Colaboratory
https://colab.research.google.com/drive/1KNsAGlGGZ_kt4Xie1o2yXC8J6qELOLAX#scrollTo=8pXj0dJZVjLR&printMode=true 3/4
plt.figure(figsize=(8,6))
plt.title('Data bathrooms')
plt.scatter(x_bathrooms,y)
plt.xlabel('area')
plt.ylabel('price')
plt.show()
def train4(x1,x2,x3,y):
#hyperparameters initialisation: tuning parameters
learning_rate=0.01
epochs=10
#model parameters initialisation
w1=0.5 #
w2=0.5
w3=0.5
bias=0.5
#recherche.....
#----------------------
n=len(y) #data size
#training
for i in range(epochs):
yhat=bias+w1*x1+w2*x2+w3*x3 #prediction
dw1=(-2/n)*np.sum(x1*(y-yhat)) # partial derivate of mse / w1
dw2=(-2/n)*np.sum(x2*(y-yhat)) # partial derivate of mse / w1
dw3=(-2/n)*np.sum(x3*(y-yhat)) # partial derivate of mse / w1
dbias=(-2/n)*np.sum((y-yhat)) #partial derivate of mse / bias
6/10/23, 11:33 PM housing_project.ipynb - Colaboratory
https://colab.research.google.com/drive/1KNsAGlGGZ_kt4Xie1o2yXC8J6qELOLAX#scrollTo=8pXj0dJZVjLR&printMode=true 4/4
 0 s terminée à 23:03
Produits payants Colab - Résilier les contrats ici
w1=w1-dw1*learning_rate #update w1
w2=w2-dw2*learning_rate #update w2
w3=w3-dw3*learning_rate #update w3
bias=bias-dbias*learning_rate #update bias
return bias,w1,w2,w3
#traning
bias,w1,w2,w3=train4(x_area,x_bedrooms,x_bathrooms,y)
def predict(x1,x2,x3):
return bias+w1*x1+w2*x2+w3*x3
#data test
x1,x2,x3=x_area,x_bedrooms,x_bathrooms
#prediction
yhat=predict(x1,x2,x3)
def mse(y,yhat):
return 1/(len(y))*np.sum((y-yhat)**2)
mseModel1=mse(y,yhat)
print(mseModel1)
1.863965268745675e+129
